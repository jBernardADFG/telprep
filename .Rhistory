df_1$day <- round(as.numeric(difftime(df_1$date, df_1$date[1], units="days")))
df <- df_1[-1,]
mod_1 <- lm(alive-126~0+day, data=df)
mod_2 <- lm((log(alive)-log(126))~0+day, data=df)
mod_3 <- lm((log(alive)-log(126))~0+day+sin(2*pi*day/365)+(cos(2*pi*day/365)), data=df)
summary(mod_1)
summary(mod_2)
summary(mod_3) # best model
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,800), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,800)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
summary(mod_3) # best model
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,800), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,800)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,800), xlab="day", ylab="live fish detected", pch=19)
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,800), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,800)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
17*30
t <- seq(0,500)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,500), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,500)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
d <- round(as.numeric(difftime(dates, tag_date, units="days")))
d <- d[-1]
d_season <- round(as.numeric(difftime(dates, df_1$date[1], units="days")))%%365
d_season <- d_season[-1]
b_1 <- summary(mod_3)$coefficients[1,1]
b_2 <- summary(mod_3)$coefficients[2,1]
b_3 <- summary(mod_3)$coefficients[3,1]
y <- 100*exp(b_1*d + b_2*sin(2*pi*d_season/365)+b_3*cos(2*pi*d_season/365))
df = mtcars
# create multiple linear model
lm_fit <- lm(mpg ~ cyl + hp, data=df)
summary(lm_fit)
# save predictions of the model in the new data frame
# together with variable you want to plot against
predicted_df <- data.frame(mpg_pred = predict(lm_fit, df), hp=df$hp)
# this is the predicted line of multiple linear regression
ggplot(data = df, aes(x = mpg, y = hp)) +
geom_point(color='blue') +
geom_line(color='red',data = predicted_df, aes(x=mpg_pred, y=hp))
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,500), xlab="day", ylab="live fish detected", pch=19)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue')
df_1 <- data.frame(
date=c("10/10/2016","11/7/2016","3/22/2017","5/8/2017","5/16/2017",
"5/23/2017","5/30/2017","6/6/2017","6/13/2017",
"6/20/2017","6/27/2017","7/19/2017","8/7/2017",
"9/1/2017","9/28/2017","11/3/2017"),
alive=c(126,99,83,76,71,74,66,66,61,56,51,45,38,33,28,22),
dead=c(0,16,25,31,36,36,42,46,47,53,54,58,64,68,78,80),
missing=c(0,11,18,19,19,16,18,14,18,17,21,23,24,25,20,24)
)
df_1$date <- as.POSIXct(df_1$date, format="%m/%d/%Y")
df_1$day <- round(as.numeric(difftime(df_1$date, df_1$date[1], units="days")))
df <- df_1[-1,]
mod_1 <- lm(alive-126~0+day, data=df)
mod_2 <- lm((log(alive)-log(126))~0+day, data=df)
mod_3 <- lm((log(alive)-log(126))~0+day+sin(2*pi*day/365)+(cos(2*pi*day/365)), data=df)
summary(mod_1)
summary(mod_2)
summary(mod_3) # best model
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,500), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,500)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
library(ggplot2)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue')
data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='green', aes(x=0, y=100))
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='green', aes(x=0, y=126))
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='green', aes(x=0, y=126)) +
xlim(0,500)+
ylim(0,130)
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,600), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,600)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='green', aes(x=0, y=126)) +
xlim(0,600)+
ylim(0,130)
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='green', aes(x=0, y=126)) +
xlim(0,600)+
ylim(0,130)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='green', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='blue') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='pink', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)
df$d
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='green') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)
df$d
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (15)),
legend.title = element_text(colour = "steelblue",  face = "bold.italic", family = "Helvetica"),
legend.text = element_text(face = "italic", colour="steelblue4",family = "Helvetica"),
axis.title = element_text(family = "Helvetica", size = (10), colour = "steelblue4"),
axis.text = element_text(family = "Courier", colour = "cornflowerblue", size = (10)))
df_1 <- data.frame(
date=c("10/10/2016","11/7/2016","3/22/2017","5/8/2017","5/16/2017",
"5/23/2017","5/30/2017","6/6/2017","6/13/2017",
"6/20/2017","6/27/2017","7/19/2017","8/7/2017",
"9/1/2017","9/28/2017","11/3/2017"),
alive=c(126,99,83,76,71,74,66,66,61,56,51,45,38,33,28,22),
dead=c(0,16,25,31,36,36,42,46,47,53,54,58,64,68,78,80),
missing=c(0,11,18,19,19,16,18,14,18,17,21,23,24,25,20,24)
)
df_1$date <- as.POSIXct(df_1$date, format="%m/%d/%Y")
df_1$day <- round(as.numeric(difftime(df_1$date, df_1$date[1], units="days")))
df_1$date
date <- as.character(df_1$date, format="%m/%d/%y")
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dates)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dates)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=date)
date <- as.character(df_1$date, format="%m/%d/%y")
date
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)
date
length(date)
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
t
df$day
length(df$day)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=df$day, labels=date[-1])
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
date <- as.character(df_1$date, format="%m/%d/%y")
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=df$day, labels=date[-1])
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dates
dts <- seq(tag_date, end_date, by=2*"month")
dts <- seq(tag_date, end_date, by="month")
dts <- dates[c(1,3,5,7,9,11,13)]
dts
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(1,3,5,7,9,11,13)]
dts <- as.character(dts, format="%m/%d/%y")
dts
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(1,3,5,7,9,11,13)]
dft <- difftime(tag_date, dts, by="days")
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(1,3,5,7,9,11,13)]
dft <- difftime(tag_date, dts, by="days")
tag_date
dts
dft <- difftime(tag_date, dts)
dft
df_1 <- data.frame(
date=c("10/10/2016","11/7/2016","3/22/2017","5/8/2017","5/16/2017",
"5/23/2017","5/30/2017","6/6/2017","6/13/2017",
"6/20/2017","6/27/2017","7/19/2017","8/7/2017",
"9/1/2017","9/28/2017","11/3/2017"),
alive=c(126,99,83,76,71,74,66,66,61,56,51,45,38,33,28,22),
dead=c(0,16,25,31,36,36,42,46,47,53,54,58,64,68,78,80),
missing=c(0,11,18,19,19,16,18,14,18,17,21,23,24,25,20,24)
)
df_1$date <- as.POSIXct(df_1$date, format="%m/%d/%Y")
df_1$day <- round(as.numeric(difftime(df_1$date, df_1$date[1], units="days")))
df <- df_1[-1,]
mod_1 <- lm(alive-126~0+day, data=df)
mod_2 <- lm((log(alive)-log(126))~0+day, data=df)
mod_3 <- lm((log(alive)-log(126))~0+day+sin(2*pi*day/365)+(cos(2*pi*day/365)), data=df)
summary(mod_1)
summary(mod_2)
summary(mod_3) # best model
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(1,3,5,7,9,11,13)]
dts <- dates[c(2,4,6,8,10,12,15)]
dft <- difftime(tag_date, dts)
dft
dft <- difftime(dts,tag_date)
dft
dft <- as.numeric(difftime(dts,tag_date))
dts <- as.character(dts, format="%m/%d/%y")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=df$day, labels=date[-1])
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts)
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(2,4,6,8,10,12,15)]
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(2,4,6,8,10,12,15)]
dft <- as.numeric(difftime(dts,tag_date))
dts <- as.character(dts, format="%m/%d/%y")
dft <- as.numeric(difftime(dts,tag_date))
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(2,4,6,8,10,12,15)]
dft <- as.numeric(difftime(dts,tag_date))
dft
dts <- dates[c(2,4,6,8,10,12,15)]
dts
dft <-as.numeric(difftime(dts,tag_date))
dft
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts, )
dts <- dates[c(2,6,10,15)]
dft <-as.numeric(difftime(dts,tag_date))
dts <- as.character(dts, format="%m/%d/%y")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts, )
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(2,6,10,15)]
dft <-as.numeric(difftime(dts,tag_date))
dts <- as.character(dts, format="%m/%d/%y")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts, )
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(2,6,10,14,18)]
dft <-as.numeric(difftime(dts,tag_date))
dts <- as.character(dts, format="%m/%d/%y")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts, )
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(2,6,10,14,18)]
plot(df$day, df$alive, ylim=c(0,126), xlim=c(0,700), xlab="day", ylab="live fish detected", pch=19)
t <- seq(0,700)
lines(t, 126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)), col="green")
points(0, 126, pch=19, col="red")
tag_date <- as.POSIXct("07/15/2020", format="%m/%d/%Y")
end_date <- as.POSIXct("01/15/2022", format="%m/%d/%Y")
dates <- seq(tag_date, end_date, by="month")
dts <- dates[c(2,6,10,14,18)]
dft <-as.numeric(difftime(dts,tag_date))
dts <- as.character(dts, format="%m/%d/%y")
library(ggplot2)
df_2 <- data.frame(t = t, f=126*exp(mod_3$coefficients[1]*t + mod_3$coefficients[2]*sin(2*pi*t/365)+mod_3$coefficients[3]*cos(2*pi*t/365)) )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts, )
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts)
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts)+
labs(title="Plot of length \n by dose",
x ="Dose (mg)", y = "Teeth length")
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts)+
labs(title="Expected Number of Live Fish Detected",
x ="n fish", y = "date")
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts)+
labs(title="Expected Number of Live Fish Detected",
x ="n fish", y = "date")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = df, aes(x = day, y = alive)) +
geom_point(color='black') +
geom_line(color='red', data=df_2, aes(x=t, y=f))+
geom_point(color='blue', aes(x=0, y=126)) +
xlim(0,700)+
ylim(0,130)+
scale_x_continuous(breaks=dft, labels=dts)+
labs(title="Expected Number of Live Fish Detected",
x ="date", y = "n fish")+
theme(plot.title = element_text(hjust = 0.5))
